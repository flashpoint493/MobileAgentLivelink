# MobileAgentLivelink 测试用例手册

## 测试用例格式

```
### TC-{模块}-{序号}: {测试名称}
- **关联**: TASK-XXX
- **前置**: {前置条件}
- **步骤**:
  1. {步骤1}
  2. {步骤2}
- **预期**: {预期结果}
- **状态**: 🟢/🟡/🔴/⚪
```

## Milestone 0.1 测试用例

### TC-DEPLOY-001: 中转服务器本地启动测试
- **关联**: Milestone 0.1
- **前置**: 
  - 已安装 Python 3.10+
  - 已安装项目依赖
- **步骤**:
  1. 进入 `relay-server` 目录
  2. 运行 `python server.py`
  3. 检查控制台输出，确认服务启动成功
  4. 在浏览器访问 `http://localhost:8765/health`
- **预期**: 
  - 服务正常启动，无错误信息
  - 健康检查接口返回 `{"status":"ok","pcs":0,"mobiles":0}`
- **状态**: ⚪

### TC-DEPLOY-002: 中转服务器公网部署测试
- **关联**: Milestone 0.1
- **前置**: 
  - 已购买腾讯云服务器
  - 已配置防火墙规则（开放 8765 端口）
- **步骤**:
  1. 使用 SSH 连接服务器
  2. 上传项目文件或使用 git clone
  3. 运行部署脚本 `bash deploy.sh` 或手动部署
  4. 检查服务状态 `systemctl status mobileagent-relay`
  5. 从本地测试健康检查 `curl http://<服务器IP>:8765/health`
- **预期**: 
  - 部署脚本执行成功
  - 服务状态为 active (running)
  - 健康检查接口可访问并返回正确响应
- **状态**: ⚪

### TC-COMM-001: PC 客户端本地连接测试
- **关联**: Milestone 0.1
- **前置**: 
  - 中转服务器在本地运行（localhost:8765）
  - PC 端已安装依赖
- **步骤**:
  1. 启动中转服务器
  2. 运行 PC 客户端 `python relay_client.py`
  3. 观察控制台输出
- **预期**: 
  - PC 客户端成功连接到中转服务器
  - 控制台显示 "已连接，设备ID: xxx"
  - 无连接错误
- **状态**: 🟢 (本地测试已通过)

### TC-COMM-002: Android 应用本地连接测试
- **关联**: Milestone 0.1
- **前置**: 
  - 中转服务器在本地运行
  - Android 应用已编译并安装到设备
  - 手机和 PC 在同一网络
- **步骤**:
  1. 启动中转服务器
  2. 在 Android 应用中输入服务器地址（PC 的局域网 IP）
  3. 点击连接
  4. 观察连接状态
- **预期**: 
  - 应用显示连接成功
  - 能够获取在线 PC 列表
  - 可以配对 PC 设备
- **状态**: ⚪

### TC-COMM-003: 端到端消息传递测试（本地）
- **关联**: Milestone 0.1
- **前置**: 
  - PC 客户端已连接
  - Android 应用已连接并配对 PC
  - Cursor 已打开
- **步骤**:
  1. 在 Android 应用中输入测试消息（如："Hello from mobile"）
  2. 点击发送
  3. 切换到 PC，查看 Cursor 对话面板
- **预期**: 
  - 消息成功发送
  - Cursor 对话面板显示收到的消息
  - Android 应用收到确认响应
- **状态**: 🟢 (本地测试已通过)

### TC-COMM-004: 端到端消息传递测试（公网）
- **关联**: Milestone 0.1
- **前置**: 
  - 中转服务器已部署到公网
  - PC 客户端配置了公网服务器地址
  - Android 应用配置了公网服务器地址
  - PC 和手机在不同网络环境
- **步骤**:
  1. 启动 PC 客户端，确认连接到公网服务器
  2. 在 Android 应用中连接公网服务器
  3. 配对 PC 设备
  4. 发送测试消息
  5. 验证消息在 Cursor 中显示
- **预期**: 
  - PC 和手机都能成功连接公网服务器
  - 消息能够跨网络传递
  - Cursor 正确接收并显示消息
- **状态**: ⚪

### TC-RELIABILITY-001: 连接断开重连测试
- **关联**: Milestone 0.1
- **前置**: 
  - PC 客户端和 Android 应用已连接
- **步骤**:
  1. 断开网络连接（或关闭中转服务器）
  2. 观察客户端行为
  3. 恢复网络连接（或重启服务器）
  4. 观察重连行为
- **预期**: 
  - 客户端检测到断开连接
  - 客户端自动尝试重连
  - 重连成功后恢复正常通信
- **状态**: ⚪

### TC-RELIABILITY-002: 多设备连接测试
- **关联**: Milestone 0.1
- **前置**: 
  - 中转服务器运行中
- **步骤**:
  1. 启动多个 PC 客户端（不同 device_id）
  2. 启动多个 Android 应用
  3. 验证所有设备都能正常连接
  4. 验证配对关系正确
- **预期**: 
  - 所有设备都能成功连接
  - 设备列表正确显示
  - 配对关系独立，互不干扰
- **状态**: ⚪

---
